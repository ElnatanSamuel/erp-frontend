(()=>{var e={};e.id=7138,e.ids=[7138],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},943:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>d,routeModule:()=>u,tree:()=>c}),a(9316),a(226),a(4872);var s=a(1218),r=a(8345),l=a(4380),n=a.n(l),i=a(306),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(t,o);let c=["",{children:["payroll",{children:["generate",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,9316)),"C:\\PROJECTS\\OCTOBER\\ERP\\apps\\frontend\\src\\app\\payroll\\generate\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,226)),"C:\\PROJECTS\\OCTOBER\\ERP\\apps\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,4872,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\PROJECTS\\OCTOBER\\ERP\\apps\\frontend\\src\\app\\payroll\\generate\\page.tsx"],p="/payroll/generate/page",x={require:a,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/payroll/generate/page",pathname:"/payroll/generate",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3280:(e,t,a)=>{Promise.resolve().then(a.bind(a,6467))},6467:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(4470),r=a(9140),l=a(4428),n=a(3209),i=a(2443),o=a(1664),c=a(756),d=a(3966),p=a(3522),x=a(375);function u(){let[e,t]=(0,o.useState)(""),[a,u]=(0,o.useState)(""),[m,h]=(0,o.useState)(()=>new Date().toISOString().slice(0,10)),[g,y]=(0,o.useState)(""),[f,v]=(0,o.useState)(""),[b,j]=(0,o.useState)(""),[N,w]=(0,o.useState)([]),[S,C]=(0,o.useState)([]),[P,E]=(0,o.useState)(null),[_,R]=(0,o.useState)(!1),[B,O]=(0,o.useState)([]),k=(0,o.useMemo)(()=>{let e=new Set;for(let t of N)t.designation&&e.add(t.designation);if(0===e.size)for(let t of S)t.title&&e.add(t.title);return Array.from(e)},[N,S]),A=(0,o.useMemo)(()=>{let e=new Date().getFullYear();return Array.from({length:6},(t,a)=>String(e-2+a))},[]),M=(0,o.useMemo)(()=>a?N.filter(e=>(e.designation||"").trim().toLowerCase()===a.trim().toLowerCase()):[],[N,a]);function q(e){return(Number(e)||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}async function T(){if(E(null),!B.length){E("Generate payroll first");return}if(!e||!a||!g||!f||!m){E("Payment name, designation, date, month and year are required");return}R(!0);try{let t=B.map(({user:t,def:a})=>({staffName:t.name,title:a.title,level:a.level,paymentName:e,payMonth:g,payYear:f,basicSalary:a.basicSalary,housingAllowance:a.allowance,transportAllowance:0,utilityAllowance:0,productivityAllowance:0,communicationAllowance:0,inconvenienceAllowance:0,grossSalary:a.grossSalary,taxPayee:a.deductions,employeePension:0,totalDeduction:a.deductions,netSalary:a.netSalary}));await (0,p.hi)("/payroll/payslips/batch",{method:"POST",body:JSON.stringify({items:t,date:m})}),await x.Cw.refresh(),window.location.href="/payroll?tab=payroll"}catch(e){E(e?.message||"Failed to generate payroll")}finally{R(!1)}}return(0,s.jsxs)("div",{className:"h-screen overflow-hidden bg-[#F6F8FB] flex",children:[s.jsx(r.default,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 lg:px-10 pt-6 pb-4 bg-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/50 border-b border-gray-100",children:[s.jsx(l.Z,{title:"Payroll",subtitle:"Generate and send payroll to account."}),s.jsx("div",{className:"mt-4",children:(0,s.jsxs)(i.default,{href:"/payroll?tab=payroll",className:"text-blue-600 hover:text-blue-700 text-sm font-medium inline-flex items-center gap-2",children:[s.jsx("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"currentColor",children:s.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})}),"Back"]})})]}),(0,s.jsxs)("div",{className:"px-6 lg:px-10 py-6 space-y-6 overflow-y-auto",children:[(0,s.jsxs)(n.Z,{className:"p-6 lg:p-7",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Generate Payroll"}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment name"}),s.jsx(c.I,{placeholder:"Enter payment name",value:e,onChange:e=>t(e.target.value)})]}),(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Designation"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("select",{value:a,onChange:e=>u(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[s.jsx("option",{value:"",children:"Select designation"}),k.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Salary definition (optional override)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[s.jsx("option",{value:"",children:"Auto-match from designation"}),S.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.title," ",e.level?`- ${e.level}`:""]},e.id))]}),s.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Date generated"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx(c.I,{type:"date",value:m,onChange:e=>h(e.target.value),className:"pr-10"}),s.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M7 10h10v2H7zm0 4h10v2H7z"})})]})]}),(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment month"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("select",{value:g,onChange:e=>y(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[s.jsx("option",{value:"",children:"Select month"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,s.jsxs)("div",{children:[s.jsx(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment year"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("select",{value:f,onChange:e=>v(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[s.jsx("option",{value:"",children:"Select year"}),A.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsx("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M7 10l5 5 5-5z"})})]})]})]}),(0,s.jsxs)("div",{className:"mt-6",children:[s.jsx("button",{onClick:function(){if(E(null),!e||!a||!g||!f||!m){E("Payment name, designation, date, month and year are required");return}if(0===M.length){E("No staff found for selected designation");return}let t=[],s=[],r=e=>(e||"").trim().toLowerCase(),l=e=>(e||"").replace(/[^A-Za-z]/g," ").split(/\s+/).filter(Boolean).map(e=>e[0]?.toUpperCase()||"").join(""),n=S.find(e=>e.id===b)||S[0];for(let e of M){let i=e.designation||a,o=S.find(e=>r(e.title)===r(i)||r(e.level)===r(i)||r(e.title).includes(r(i))||r(i).includes(r(e.title))||r(e.level).includes(r(i))||l(e.title)===l(i)||l(e.level)===l(i));o?t.push({user:e,def:o}):n?t.push({user:e,def:n}):s.push(e.name)}if(0===t.length){E("No salary definition available. Please create one in Salary Breakdown.");return}s.length>0&&E(`No salary definition for ${s.length} staff; using fallback for others`),O(e=>{let s=e=>(e||"").trim().toLowerCase(),r=e=>`${s(e.name)}|${s(e.designation||a)}`,l=new Set(e.map(e=>r(e.user)));return[...e,...t.filter(e=>{let t=r(e.user);return!l.has(t)&&(l.add(t),!0)})]})},className:"inline-flex items-center justify-center h-11 px-8 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm",children:"Generate Payroll"}),P&&s.jsx("span",{className:"ml-3 text-sm text-rose-600",children:P})]})]}),(0,s.jsxs)(n.Z,{className:"p-0",children:[s.jsx("div",{className:"p-5 pb-0",children:s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Staff Details"})}),(0,s.jsxs)("div",{className:"p-5 pt-3",children:[s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"text-left text-gray-500 border-y bg-gray-50",children:[s.jsx("th",{className:"px-5 py-3 font-medium",children:"S/N"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Staff Name"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Title"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Level"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Basic Salary"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Allowances"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Gross Salary"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Deduction"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Net Salary"}),s.jsx("th",{className:"px-5 py-3 font-medium",children:"Action"})]})}),s.jsx("tbody",{children:0===B.length?s.jsx("tr",{children:s.jsx("td",{className:"px-5 py-8 text-sm text-gray-500",colSpan:10,children:"No staff generated yet. Select designation and click Generate Payroll."})}):B.map(({user:e,def:t},a)=>(0,s.jsxs)("tr",{className:"border-b last:border-0",children:[s.jsx("td",{className:"px-5 py-4",children:String(a+1).padStart(2,"0")}),s.jsx("td",{className:"px-5 py-4 text-gray-900",children:e.name}),s.jsx("td",{className:"px-5 py-4",children:t.title}),s.jsx("td",{className:"px-5 py-4",children:t.level}),s.jsx("td",{className:"px-5 py-4",children:q(t.basicSalary)}),s.jsx("td",{className:"px-5 py-4",children:q(t.allowance)}),s.jsx("td",{className:"px-5 py-4",children:q(t.grossSalary)}),s.jsx("td",{className:"px-5 py-4",children:q(t.deductions)}),s.jsx("td",{className:"px-5 py-4",children:q(t.netSalary)}),s.jsx("td",{className:"px-5 py-4 text-blue-600",children:s.jsx("button",{onClick:()=>O(t=>t.filter(t=>!(t.user.id===e.id&&(t.user.designation||"")===(e.designation||"")))),className:"hover:underline",children:"Remove"})})]},e.id))})]})}),s.jsx("div",{className:"mt-5",children:s.jsx("button",{onClick:T,disabled:_||0===B.length,className:"inline-flex items-center justify-center h-11 px-8 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm disabled:opacity-50",children:_?"Submitting...":"Submit"})})]})]}),s.jsx("footer",{className:"text-center text-xs text-gray-400 pt-2 pb-6",children:"Copyright \xa9 2025 Relia Energy. All Rights Reserved"})]})]})]})}},4428:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s.default});var s=a(9710)},756:(e,t,a)=>{"use strict";a.d(t,{I:()=>n});var s=a(4470),r=a(1664),l=a(5905);let n=r.forwardRef(({className:e,...t},a)=>s.jsx("input",{ref:a,className:(0,l.W)("flex h-12 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm","placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50",e),...t}));n.displayName="Input"},3966:(e,t,a)=>{"use strict";a.d(t,{_:()=>l});var s=a(4470);a(1664);var r=a(5905);function l({className:e,...t}){return s.jsx("label",{className:(0,r.W)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t})}},375:(e,t,a)=>{"use strict";a.d(t,{Cw:()=>o,D4:()=>n,RM:()=>i,gr:()=>l});var s=a(1750),r=a(3522);let l=(0,s.vg)(async()=>(0,r.hi)("/payroll/kpis"));(0,s.vg)(async()=>(0,r.hi)("/payroll/summary"));let n=(0,s.vg)(async()=>(0,r.hi)("/payroll/definitions")),i=(0,s.vg)(async()=>(0,r.hi)("/payroll/taxes")),o=(0,s.vg)(async()=>(0,r.hi)("/payroll/payslips"))},9316:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var s=a(4259);let r=(0,s.createProxy)(String.raw`C:\PROJECTS\OCTOBER\ERP\apps\frontend\src\app\payroll\generate\page.tsx`),{__esModule:l,$$typeof:n}=r;r.default;let i=(0,s.createProxy)(String.raw`C:\PROJECTS\OCTOBER\ERP\apps\frontend\src\app\payroll\generate\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[4966,3203,1410],()=>a(943));module.exports=s})();