(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5193],{157:function(e,t,a){Promise.resolve().then(a.bind(a,5508))},5508:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var s=a(1514),r=a(2610),l=a(10),n=a(542),i=a(7993),c=a(8861);function o(){let[e,t]=(0,i.useState)([]),[a,o]=(0,i.useState)(0),[d,u]=(0,i.useState)(!0),[x,h]=(0,i.useState)(null),[f,m]=(0,i.useState)([]);async function p(){u(!0),h(null);try{let e=await (0,c.hi)("/notifications");t(e.items||[]),o(e.unreadCount||0),m([])}catch(e){h((null==e?void 0:e.message)||"Failed to load")}finally{u(!1)}}(0,i.useEffect)(()=>{p()},[]);let g=(0,i.useMemo)(()=>{let t={},a=new Date;a.setHours(0,0,0,0);let s=new Date(a);for(let r of(s.setDate(a.getDate()-1),e)){let e=r.createdAt?new Date(r.createdAt):new Date,l=e<s?e.toLocaleDateString():e>=a?"Today":"Yesterday";t[l]=t[l]||[],t[l].push(r)}let r=e=>"Today"===e?0:"Yesterday"===e?1:2;return Object.keys(t).sort((e,t)=>r(e)-r(t)).map(e=>({label:e,list:t[e]}))},[e]);async function y(){await (0,c.hi)("/notifications/mark-all-read",{method:"POST",body:JSON.stringify({})}),await p()}return(0,s.jsxs)("div",{className:"h-screen overflow-hidden bg-[#F6F8FB] flex",children:[(0,s.jsx)(r.default,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 lg:px-10 pt-6 pb-4 bg-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/50 border-b border-gray-100",children:(0,s.jsx)(l.Z,{title:"Notifications",subtitle:"Read and delete notifications."})}),(0,s.jsxs)("div",{className:"px-6 lg:px-10 py-6 space-y-6 overflow-y-auto",children:[(0,s.jsxs)(n.Z,{className:"p-6 lg:p-7 flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-gray-900",children:["Notifications (",a," unread)"]}),(0,s.jsx)("button",{onClick:y,className:"inline-flex items-center justify-center h-10 px-5 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm",children:"Mark All As Read"})]}),(0,s.jsx)(n.Z,{className:"p-0",children:(0,s.jsx)("div",{className:"p-5 pt-3 overflow-y-auto",children:d?(0,s.jsx)("div",{className:"text-sm text-gray-500 px-1 py-10",children:"Loading…"}):x?(0,s.jsx)("div",{className:"text-sm text-rose-600 px-1 py-10",children:x}):0===e.length?(0,s.jsx)("div",{className:"text-sm text-gray-500 px-1 py-10",children:"No notifications"}):(0,s.jsx)("div",{className:"space-y-6",children:g.map(e=>{let{label:t,list:a}=e;return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 px-1",children:[(0,s.jsx)("div",{className:"font-medium text-gray-500",children:t}),(0,s.jsxs)("label",{className:"inline-flex items-center gap-2 cursor-pointer select-none",children:[(0,s.jsx)("input",{type:"checkbox",onChange:e=>(function(e,t){var a;let s=(null===(a=g.find(t=>t.label===e))||void 0===a?void 0:a.list.map(e=>e.id))||[];m(e=>{let a=new Set(e);for(let e of s)t?a.add(e):a.delete(e);return Array.from(a)})})(t,e.target.checked)}),(0,s.jsx)("span",{children:"Select all"})]})]}),(0,s.jsx)("div",{className:"space-y-3",children:a.map(e=>{var t;return(0,s.jsxs)("div",{className:(e.read?"bg-white":"bg-blue-50/40")+" rounded-xl border border-gray-100 px-4 py-3 flex items-center gap-3",children:[(0,s.jsx)("img",{src:e.actorPhotoUrl?e.actorPhotoUrl.startsWith("http")?e.actorPhotoUrl:"".concat(c.Y_).concat(e.actorPhotoUrl):"https://via.placeholder.com/40",alt:"avatar",className:"h-9 w-9 rounded-full object-cover"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"text-gray-900 text-sm truncate",children:e.message}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:function(e){if(!e)return"";let t=new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)return"".concat(a,"min ago").replace(/^0/,"1");let s=Math.floor(a/60);if(s<60)return"".concat(s,"min ago");let r=Math.floor(s/60);if(r<24)return"".concat(r,"hr ago");let l=Math.floor(r/24);return"".concat(l," day").concat(l>1?"s":""," ago")}(e.createdAt)})]}),!e.read&&(0,s.jsx)("span",{className:"h-2.5 w-2.5 rounded-full bg-blue-500"}),(0,s.jsx)("input",{type:"checkbox",checked:(t=e.id,f.includes(t)),onChange:t=>m(a=>t.target.checked?[...a,e.id]:a.filter(t=>t!==e.id))}),(0,s.jsx)("button",{className:"ml-2 text-gray-500 hover:text-gray-700",title:"More",children:"⋯"})]},e.id)})})]},t)})})})})]})]})]})}},10:function(e,t,a){"use strict";a.d(t,{Z:function(){return s.default}});var s=a(6615)}},function(e){e.O(0,[9044,1906,3881,3869,8753,1744],function(){return e(e.s=157)}),_N_E=e.O()}]);