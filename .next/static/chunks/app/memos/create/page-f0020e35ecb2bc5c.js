(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2990],{4588:function(e,t,a){Promise.resolve().then(a.bind(a,4436))},4436:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var l=a(1514),s=a(2610),n=a(10),r=a(542),c=a(9170),i=a(7993),o=a(5120),d=a(8861),m=a(7107);function h(e,t){return{...e,...t}}function x(){var e,t,a;let{data:x}=m.U.useSession(),[u,g]=(0,i.useState)([]),[p,b]=(0,i.useReducer)(h,{title:"",sentFrom:"",sentTo:"",date:"",hasAttachment:!1,action:"",attachmentType:"",body:"",cc:[],attachmentName:"",attachmentUrl:""}),[v,f]=(0,i.useState)(!1),[y,j]=(0,i.useState)(null),[N,w]=(0,i.useState)(!1),[C,k]=(0,i.useState)(null);async function F(){if(j(null),!p.title.trim()){j("Title is required");return}if(!p.sentTo.trim()){j("Please select recipient");return}f(!0);try{await (0,d.hi)("/memos",{method:"POST",body:JSON.stringify({title:p.title,sentFrom:p.sentFrom,sentTo:p.sentTo,date:p.date,hasAttachment:p.hasAttachment,type:"Sent",action:p.action,attachmentType:p.attachmentType,body:p.body,cc:p.cc,attachmentName:p.attachmentName,attachmentUrl:p.attachmentUrl})}),k("/memos"),w(!0)}catch(e){j((null==e?void 0:e.message)||"Failed to create memo")}finally{f(!1)}}async function S(e){let t=e.target.files&&e.target.files[0];if(!t)return;let a=new FormData;a.append("file",t);try{let e=await (0,d.BG)("/memos/upload",a);b({hasAttachment:!0,attachmentType:p.attachmentType||"Payment Voucher",attachmentName:e.name,attachmentUrl:e.url})}catch(e){j((null==e?void 0:e.message)||"Upload failed")}finally{e.target.value=""}}return(0,i.useEffect)(()=>{var e;let t=(null==x?void 0:null===(e=x.user)||void 0===e?void 0:e.name)||"";t&&b({sentFrom:t})},[x]),(0,i.useEffect)(()=>{if(N&&C){let e=setTimeout(()=>{window.location.href=C},1200);return()=>clearTimeout(e)}},[N,C]),(0,i.useEffect)(()=>{(async()=>{try{let e=await (0,d.hi)("/users"),t=new Set;for(let a of e.items||[]){let e=a.name||"".concat(a.firstName||""," ").concat(a.lastName||"").trim();e&&t.add(e)}g(Array.from(t))}catch(e){}})()},[]),(0,l.jsxs)("div",{className:"h-screen overflow-hidden bg-[#F6F8FB] flex",children:[(0,l.jsx)(s.default,{}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-6 lg:px-10 pt-6 pb-4 bg-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/50 border-b border-gray-100",children:[(0,l.jsx)(n.Z,{title:"Memo",subtitle:"Create memo"}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsxs)(c.default,{href:"/memos",className:"text-blue-600 hover:text-blue-700 text-sm font-medium inline-flex items-center gap-2",children:[(0,l.jsx)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"currentColor",children:(0,l.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})}),"Back"]})})]}),(0,l.jsx)("div",{className:"px-6 lg:px-10 py-6 space-y-6 overflow-y-auto",children:(0,l.jsxs)(r.Z,{className:"p-6 lg:p-7",children:[(0,l.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"Create Memo"}),(0,l.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Memo title"}),(0,l.jsx)(o.I,{placeholder:"Enter title",value:p.title,onChange:e=>b({title:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Sent from"}),(0,l.jsx)(o.I,{value:p.sentFrom,onChange:e=>b({sentFrom:e.target.value}),readOnly:!0,disabled:!0,className:"bg-gray-100"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Sent to"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:p.sentTo,onChange:e=>b({sentTo:e.target.value}),className:"w-full h-11 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700",children:[(0,l.jsx)("option",{value:"",children:"Select option"}),u.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Action"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:p.action,onChange:e=>b({action:e.target.value}),className:"w-full h-11 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700",children:[(0,l.jsx)("option",{value:"",children:"Select option"}),["Approval","For Information","Urgent"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Date"}),(0,l.jsx)(o.I,{type:"date",value:p.date,onChange:e=>b({date:e.target.value})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"CC 1"}),(0,l.jsx)(o.I,{placeholder:"Optional",value:(null===(e=p.cc)||void 0===e?void 0:e[0])||"",onChange:e=>{let t=[...p.cc||[]];t[0]=e.target.value,b({cc:t})}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"CC 2"}),(0,l.jsx)(o.I,{placeholder:"Optional",value:(null===(t=p.cc)||void 0===t?void 0:t[1])||"",onChange:e=>{let t=[...p.cc||[]];t[1]=e.target.value,b({cc:t})}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"CC 3"}),(0,l.jsx)(o.I,{placeholder:"Optional",value:(null===(a=p.cc)||void 0===a?void 0:a[2])||"",onChange:e=>{let t=[...p.cc||[]];t[2]=e.target.value,b({cc:t})}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Add attachment?"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:p.hasAttachment?"Yes":"No",onChange:e=>b({hasAttachment:"Yes"===e.target.value}),className:"w-full h-11 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700",children:[(0,l.jsx)("option",{children:"No"}),(0,l.jsx)("option",{children:"Yes"})]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Attachment type"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:p.attachmentType,onChange:e=>b({attachmentType:e.target.value}),className:"w-full h-11 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700",children:[(0,l.jsx)("option",{value:"",children:"Select type"}),["Payment Voucher","Document","Image","Other"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{className:"md:col-span-3",children:[(0,l.jsx)("label",{className:"block text-sm text-gray-600 mb-2",children:"Memo body"}),(0,l.jsx)("textarea",{placeholder:"Enter subject",value:p.body,onChange:e=>b({body:e.target.value}),className:"w-full rounded-xl border border-gray-200 bg-white px-4 py-3 text-sm text-gray-700 min-h-[120px]"})]})]}),(0,l.jsxs)("div",{className:"mt-8 flex items-center gap-4",children:[(0,l.jsx)("input",{id:"memo_file_input",type:"file",onChange:S,className:"hidden"}),(0,l.jsx)("button",{type:"button",onClick:function(){let e=document.getElementById("memo_file_input");e&&e.click()},className:"inline-flex items-center justify-center h-11 px-6 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm",children:"Attach Payment Voucher"}),p.attachmentName&&(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:["Attached: ",p.attachmentName]}),(0,l.jsx)("button",{onClick:F,disabled:v,className:"inline-flex items-center justify-center h-11 px-8 rounded-xl border border-gray-200 bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:v?"Sendingâ€¦":"Send Memo"}),y&&(0,l.jsx)("span",{className:"text-sm text-rose-600",children:y})]})]})})]}),N&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl w-[320px] p-6 text-center",children:[(0,l.jsx)("div",{className:"mx-auto h-12 w-12 rounded-full bg-green-100 grid place-items-center mb-3",children:(0,l.jsx)("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-green-600",fill:"currentColor",children:(0,l.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}),(0,l.jsx)("div",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Congratulations"}),(0,l.jsx)("div",{className:"text-sm text-gray-600 mb-5",children:"Your memo has been created and sent successfully."}),(0,l.jsx)("button",{onClick:()=>{w(!1),C&&(window.location.href=C)},className:"inline-flex items-center justify-center h-10 px-6 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm",children:"Ok"})]})})]})}},10:function(e,t,a){"use strict";a.d(t,{Z:function(){return l.default}});var l=a(6615)},5120:function(e,t,a){"use strict";a.d(t,{I:function(){return r}});var l=a(1514),s=a(7993),n=a(3053);let r=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("input",{ref:t,className:(0,n.W)("flex h-12 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm","placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50",a),...s})});r.displayName="Input"}},function(e){e.O(0,[9044,1906,3881,3869,8753,1744],function(){return e(e.s=4588)}),_N_E=e.O()}]);