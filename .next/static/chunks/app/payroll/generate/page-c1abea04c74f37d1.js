(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7138],{9070:function(e,t,a){Promise.resolve().then(a.bind(a,7829))},7829:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var l=a(1514),s=a(2610),r=a(10),n=a(542),i=a(9170),o=a(7993),c=a(5120),d=a(2917),u=a(8861),x=a(8389);function m(){let[e,t]=(0,o.useState)(""),[a,m]=(0,o.useState)(""),[h,p]=(0,o.useState)(()=>new Date().toISOString().slice(0,10)),[f,y]=(0,o.useState)(""),[g,v]=(0,o.useState)(""),[b,j]=(0,o.useState)(""),[N,w]=(0,o.useState)([]),[S,C]=(0,o.useState)([]),[k,A]=(0,o.useState)(null),[B,D]=(0,o.useState)(!1),[P,_]=(0,o.useState)([]);(0,o.useEffect)(()=>{let e=x.D4.subscribe(e=>{e.data&&C(e.data.items)});return x.D4.refresh().catch(()=>void 0),(async()=>{try{let e=await (0,u.hi)("/users");(null==e?void 0:e.items)&&w(e.items.map(e=>({id:String(e.id),name:e.name||"".concat(e.firstName||""," ").concat(e.lastName||"").trim(),designation:e.designation})))}catch(e){}})(),()=>{e()}},[]);let F=(0,o.useMemo)(()=>{let e=new Set;for(let t of N)t.designation&&e.add(t.designation);if(0===e.size)for(let t of S)t.title&&e.add(t.title);return Array.from(e)},[N,S]),M=(0,o.useMemo)(()=>{let e=new Date().getFullYear();return Array.from({length:6},(t,a)=>String(e-2+a))},[]),E=(0,o.useMemo)(()=>a?N.filter(e=>(e.designation||"").trim().toLowerCase()===a.trim().toLowerCase()):[],[N,a]);function z(e){return(Number(e)||0).toLocaleString("en-US",{style:"currency",currency:"USD"})}async function L(){if(A(null),!P.length){A("Generate payroll first");return}if(!e||!a||!f||!g||!h){A("Payment name, designation, date, month and year are required");return}D(!0);try{let t=P.map(t=>{let{user:a,def:l}=t;return{staffName:a.name,title:l.title,level:l.level,paymentName:e,payMonth:f,payYear:g,basicSalary:l.basicSalary,housingAllowance:l.allowance,transportAllowance:0,utilityAllowance:0,productivityAllowance:0,communicationAllowance:0,inconvenienceAllowance:0,grossSalary:l.grossSalary,taxPayee:l.deductions,employeePension:0,totalDeduction:l.deductions,netSalary:l.netSalary}});await (0,u.hi)("/payroll/payslips/batch",{method:"POST",body:JSON.stringify({items:t,date:h})}),await x.Cw.refresh(),window.location.href="/payroll?tab=payroll"}catch(e){A((null==e?void 0:e.message)||"Failed to generate payroll")}finally{D(!1)}}return(0,l.jsxs)("div",{className:"h-screen overflow-hidden bg-[#F6F8FB] flex",children:[(0,l.jsx)(s.default,{}),(0,l.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,l.jsxs)("div",{className:"px-6 lg:px-10 pt-6 pb-4 bg-white/60 backdrop-blur supports-[backdrop-filter]:bg-white/50 border-b border-gray-100",children:[(0,l.jsx)(r.Z,{title:"Payroll",subtitle:"Generate and send payroll to account."}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsxs)(i.default,{href:"/payroll?tab=payroll",className:"text-blue-600 hover:text-blue-700 text-sm font-medium inline-flex items-center gap-2",children:[(0,l.jsx)("svg",{viewBox:"0 0 24 24",className:"h-4 w-4",fill:"currentColor",children:(0,l.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})}),"Back"]})})]}),(0,l.jsxs)("div",{className:"px-6 lg:px-10 py-6 space-y-6 overflow-y-auto",children:[(0,l.jsxs)(n.Z,{className:"p-6 lg:p-7",children:[(0,l.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"Generate Payroll"}),(0,l.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment name"}),(0,l.jsx)(c.I,{placeholder:"Enter payment name",value:e,onChange:e=>t(e.target.value)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Designation"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:a,onChange:e=>m(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,l.jsx)("option",{value:"",children:"Select designation"}),F.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Salary definition (optional override)"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:b,onChange:e=>j(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,l.jsx)("option",{value:"",children:"Auto-match from designation"}),S.map(e=>(0,l.jsxs)("option",{value:e.id,children:[e.title," ",e.level?"- ".concat(e.level):""]},e.id))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Date generated"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(c.I,{type:"date",value:h,onChange:e=>p(e.target.value),className:"pr-10"}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10h10v2H7zm0 4h10v2H7z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment month"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:f,onChange:e=>y(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,l.jsx)("option",{value:"",children:"Select month"}),["January","February","March","April","May","June","July","August","September","October","November","December"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(d._,{className:"block text-sm text-gray-600 mb-2",children:"Payment year"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("select",{value:g,onChange:e=>v(e.target.value),className:"w-full h-12 appearance-none rounded-xl border border-gray-200 bg-white px-4 pr-10 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-600",children:[(0,l.jsx)("option",{value:"",children:"Select year"}),M.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]}),(0,l.jsx)("svg",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400",viewBox:"0 0 24 24",fill:"currentColor",children:(0,l.jsx)("path",{d:"M7 10l5 5 5-5z"})})]})]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("button",{onClick:function(){if(A(null),!e||!a||!f||!g||!h){A("Payment name, designation, date, month and year are required");return}if(0===E.length){A("No staff found for selected designation");return}let t=[],l=[],s=e=>(e||"").trim().toLowerCase(),r=e=>(e||"").replace(/[^A-Za-z]/g," ").split(/\s+/).filter(Boolean).map(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())||""}).join(""),n=S.find(e=>e.id===b)||S[0];for(let e of E){let i=e.designation||a,o=S.find(e=>s(e.title)===s(i)||s(e.level)===s(i)||s(e.title).includes(s(i))||s(i).includes(s(e.title))||s(e.level).includes(s(i))||r(e.title)===r(i)||r(e.level)===r(i));o?t.push({user:e,def:o}):n?t.push({user:e,def:n}):l.push(e.name)}if(0===t.length){A("No salary definition available. Please create one in Salary Breakdown.");return}l.length>0&&A("No salary definition for ".concat(l.length," staff; using fallback for others")),_(e=>{let l=e=>(e||"").trim().toLowerCase(),s=e=>"".concat(l(e.name),"|").concat(l(e.designation||a)),r=new Set(e.map(e=>s(e.user)));return[...e,...t.filter(e=>{let t=s(e.user);return!r.has(t)&&(r.add(t),!0)})]})},className:"inline-flex items-center justify-center h-11 px-8 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm",children:"Generate Payroll"}),k&&(0,l.jsx)("span",{className:"ml-3 text-sm text-rose-600",children:k})]})]}),(0,l.jsxs)(n.Z,{className:"p-0",children:[(0,l.jsx)("div",{className:"p-5 pb-0",children:(0,l.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:"Staff Details"})}),(0,l.jsxs)("div",{className:"p-5 pt-3",children:[(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"text-left text-gray-500 border-y bg-gray-50",children:[(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"S/N"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Staff Name"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Title"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Level"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Basic Salary"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Allowances"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Gross Salary"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Deduction"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Net Salary"}),(0,l.jsx)("th",{className:"px-5 py-3 font-medium",children:"Action"})]})}),(0,l.jsx)("tbody",{children:0===P.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{className:"px-5 py-8 text-sm text-gray-500",colSpan:10,children:"No staff generated yet. Select designation and click Generate Payroll."})}):P.map((e,t)=>{let{user:a,def:s}=e;return(0,l.jsxs)("tr",{className:"border-b last:border-0",children:[(0,l.jsx)("td",{className:"px-5 py-4",children:String(t+1).padStart(2,"0")}),(0,l.jsx)("td",{className:"px-5 py-4 text-gray-900",children:a.name}),(0,l.jsx)("td",{className:"px-5 py-4",children:s.title}),(0,l.jsx)("td",{className:"px-5 py-4",children:s.level}),(0,l.jsx)("td",{className:"px-5 py-4",children:z(s.basicSalary)}),(0,l.jsx)("td",{className:"px-5 py-4",children:z(s.allowance)}),(0,l.jsx)("td",{className:"px-5 py-4",children:z(s.grossSalary)}),(0,l.jsx)("td",{className:"px-5 py-4",children:z(s.deductions)}),(0,l.jsx)("td",{className:"px-5 py-4",children:z(s.netSalary)}),(0,l.jsx)("td",{className:"px-5 py-4 text-blue-600",children:(0,l.jsx)("button",{onClick:()=>_(e=>e.filter(e=>!(e.user.id===a.id&&(e.user.designation||"")===(a.designation||"")))),className:"hover:underline",children:"Remove"})})]},a.id)})})]})}),(0,l.jsx)("div",{className:"mt-5",children:(0,l.jsx)("button",{onClick:L,disabled:B||0===P.length,className:"inline-flex items-center justify-center h-11 px-8 rounded-xl text-white bg-gradient-to-r from-[#1D75FF] via-[#5B6EF5] to-[#1B57E9] hover:brightness-105 shadow-sm disabled:opacity-50",children:B?"Submitting...":"Submit"})})]})]}),(0,l.jsx)("footer",{className:"text-center text-xs text-gray-400 pt-2 pb-6",children:"Copyright \xa9 2025 Relia Energy. All Rights Reserved"})]})]})]})}},10:function(e,t,a){"use strict";a.d(t,{Z:function(){return l.default}});var l=a(6615)},5120:function(e,t,a){"use strict";a.d(t,{I:function(){return n}});var l=a(1514),s=a(7993),r=a(3053);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,l.jsx)("input",{ref:t,className:(0,r.W)("flex h-12 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm","placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent","disabled:cursor-not-allowed disabled:opacity-50",a),...s})});n.displayName="Input"},2917:function(e,t,a){"use strict";a.d(t,{_:function(){return r}});var l=a(1514);a(7993);var s=a(3053);function r(e){let{className:t,...a}=e;return(0,l.jsx)("label",{className:(0,s.W)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...a})}},8389:function(e,t,a){"use strict";a.d(t,{CT:function(){return n},Cw:function(){return c},D4:function(){return i},RM:function(){return o},gr:function(){return r}});var l=a(8775),s=a(8861);let r=(0,l.vg)(async()=>(0,s.hi)("/payroll/kpis")),n=(0,l.vg)(async()=>(0,s.hi)("/payroll/summary")),i=(0,l.vg)(async()=>(0,s.hi)("/payroll/definitions")),o=(0,l.vg)(async()=>(0,s.hi)("/payroll/taxes")),c=(0,l.vg)(async()=>(0,s.hi)("/payroll/payslips"))}},function(e){e.O(0,[9044,1906,3881,3869,8753,1744],function(){return e(e.s=9070)}),_N_E=e.O()}]);